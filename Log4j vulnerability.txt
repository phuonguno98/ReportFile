#About Log4j:
Apache Log4j hay thường gọi là Log4j là một trình ghi log (thư viện/framework) được viết bằng ngôn ngữ Java. Apache Log4j là một mã nguồn mở cung cấp bởi Apache.
Cách thành phần chính của Log4j:
+ loggers: Chịu trách nhiệm thu thập thông tin log
+ appenders: Chịu trách nhiệm ghi log tới các vị trí đã được cấu hình (file, console)
+ layouts: Chịu trách nhiệm định dạng (format) kết quả log

#Log4j vulnerability:
Log4Shell là một lỗ hổng thực thi mã từ xa (RCE, code injection) chưa được xác thực . Bằng cách khai thác nó, kẻ tấn công có thể dễ dàng thực thi bất kỳ mã nào từ một nguồn từ xa trên mục tiêu bị tấn công.

#Mitigate Log4Shell:
- Cập nhật Log4j lên phiên bản 2.17.0 hoặc cao hơn.
- Nếu không thể nâng cấp lên 2.17.0 hoặc cao hơn, hãy chọn một trong các giải pháp tạm thời sau:
	+ Sửa đổi JNDI theo cách thủ công hoặc bằng cách sử dụng các công cụ như hotpatch-for-apache-log4j2
	+ Xóa lớp JndiLookup khỏi classpath:
	>> zip -q -d log4j-core-*.jar org/apache/logging/log4j/core/lookup/JndiLookup.class
	+ Trong PatternLayout trong cấu hình ghi nhật ký, hãy thay thế các tra cứu ngữ cảnh như ${ctx:loginId}hoặc $${ctx:loginId}bằng các mẫu bản đồ ngữ cảnh chuỗi ( hoặc %X) . Nếu không, trong cấu hình, hãy xóa các tham chiếu đến tra cứu ngữ cảnh như hoặc nơi chúng bắt nguồn từ các nguồn bên ngoài ứng dụng, chẳng hạn như tiêu đề HTTP hoặc đầu vào của người dùng.%mdc%MDC${ctx:loginId}$${ctx:loginId}
	+ Đối với phiên bản 2.10.0 hoặc cũ hơn, hãy đặt formatMsgNoLookups = true khi định cấu hình Log4j (nhưng lưu ý rằng điều này không đảm bảo bảo vệ hoàn toàn do CVE-2021-45046 ):
		. Truyền một đối số khi gọi Java:
		>>java -Dlog4j2.formatMsgNoLookups=true ...
		. Đặt biến môi trường:
		>>LOG4J_FORMAT_MSG_NO_LOOKUPS=true java ...
		.Đặt biến môi trường đối số JVM:
		>>JAVA_OPTS=-Dlog4j2.formatMsgNoLookups=true

#For more information
[1] https://learn.snyk.io/lessons/log4shell/java/
[2] https://www.acunetix.com/blog/web-security-zone/critical-alert-log4shell-cve-2021-44228-in-log4j-possibly-the-biggest-impact-vulnerability-ever/
[3] https://cybersec365.org/how-to/thu-thuat-bao-mat/lo-hong-bao-mat-log4j-kiem-thu/